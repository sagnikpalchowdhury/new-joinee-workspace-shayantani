<h2>Create Student</h2>
<form #studentForm="ngForm" (ngSubmit)="onSubmit(studentForm.value)">
        
    <label class="heading">Name</label>
    <mat-form-field appearance="outline" class="full-width-input">
        <mat-label>Name</mat-label>
        <input matInput type="text" id="name" name="name" [(ngModel)]="student.name" required #name="ngModel" autocomplete="name">
        @if (name.invalid && (name.dirty || name.touched)) {
            <mat-error>Name is required.</mat-error>
        }
    </mat-form-field>

    <label class="heading">Email</label>
    <mat-form-field appearance="outline" class="full-width-input">
        <mat-label>Email</mat-label>
        <input matInput type="email" id="email" name="email" [(ngModel)]="student.email" required email #email="ngModel" autocomplete="email">
        @if (email.invalid && (email.dirty || email.touched)) {
            <mat-error>Email is required.</mat-error>
        }
    </mat-form-field>

    <label class="heading">Date of Birth</label>
    <mat-form-field appearance="outline" class="full-width-input">
        <mat-label>Date of Birth</mat-label>
        <input matInput [matDatepicker]="picker" id="dob" name="dateOfBirth" [(ngModel)]="student.dateOfBirth" required #dobField="ngModel">

        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-hint>MM/DD/YYYY</mat-hint>
        <mat-datepicker #picker></mat-datepicker>
        
        @if (dobField.invalid && (dobField.dirty || dobField.touched)) {
            <mat-error>Date of Birth is required.</mat-error>
        }
    </mat-form-field>

    <div class="form__input">
        <label class="heading">Gender</label>
        <mat-radio-group name="gender" [(ngModel)]="student.gender" required class="radio-group">
            <mat-radio-button value="Male">Male</mat-radio-button>
            <mat-radio-button value="Female">Female</mat-radio-button>
        </mat-radio-group>
        @if (student.gender === '' && studentForm.submitted) {
            <div class="error-text">Gender is required.</div>
        }
    </div>

    <label class="heading">Country</label>
    <mat-form-field appearance="outline" class="full-width-input">
        <mat-label>Country</mat-label>
        <mat-select id="country" name="country" [(ngModel)]="student.country" required #countryField="ngModel">
            <mat-option [value]="''" disabled>Select Country</mat-option>
            @for (country of countries; track country) {
                <mat-option [value]="country">{{ country }}</mat-option>
            }
        </mat-select>
        @if (countryField.invalid && (countryField.dirty || countryField.touched)) {
            <mat-error>Country is required.</mat-error>
        }
    </mat-form-field>

    @if (student.country) {
        <course-selection
            [selectedCountry]="student.country"
            [submitted]="studentForm.submitted"
            (coursesChange)="onCoursesChanged($event)"
            (isValidChange)="onValidationChanged($event)">
        </course-selection>
    }

    <button 
        mat-raised-button type="submit" class="button__submit"
        [disabled]="isSaving() || studentForm.invalid || !isCourseSelectionValid" >
        Submit
    </button>
</form>